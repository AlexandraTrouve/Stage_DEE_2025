aucOthers<-list(stage1[[1]],stage1[[2]],stage1[[3]])
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
model <- tools::file_path_sans_ext(basename(str_extract(pos1, "(?<=using_)[a-zA-Z0-9_]")))
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^[^_]+")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(pos1))
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[a-zA-Z0-9_]")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^[^_]+")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^[^_]+")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^[^.]+")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^(.*?)(?=_neg)")
plotLegend <- append(plotLegend, cluster)}
View(plotLegend)
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^(.*?)(?=_pos)")
plotLegend <- append(plotLegend, cluster)}
View(plotLegend)
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^(.*?)(?=_pos)")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i-1],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_pos.pred.using_late_constraint_model.txt'
hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_neg.pred.using_late_constraint_model.txt'
inverse_hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_pos.pred.using_late_constraint_model.txt'
inverse_hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_neg.pred.using_late_constraint_model.txt'
early_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_pos.pred.using_late_constraint_model.txt'
early_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_neg.pred.using_late_constraint_model.txt'
late_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_pos.pred.using_late_constraint_model.txt'
late_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_neg.pred.using_late_constraint_model.txt'
uniform_high_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_pos.pred.using_late_constraint_model.txt'
uniform_high_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_neg.pred.using_late_constraint_model.txt'
uniform_low_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_pos.pred.using_late_constraint_model.txt'
uniform_low_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_neg.pred.using_late_constraint_model.txt'
pos_files <- list(hourglass_pos, inverse_hourglass_pos, early_constraint_pos,
late_constraint_pos, uniform_high_pos, uniform_low_pos)
neg_files <- list(hourglass_neg, inverse_hourglass_neg, early_constraint_neg,
late_constraint_neg, uniform_high_neg, uniform_low_neg)
output_file = '/Users/children/Desktop/Stage_2025/Results/analyses/clean2/promoters/AUC/early_constraint_scores_OtherModel.pdf'
##### take T1 enhancers as an example #####
## T1 model cross validation
pos1<-fread(pos_files[[1]])
neg1<-fread(neg_files[[1]])
## T1 enhancers prediction based on T2 model
pos2<-fread(pos_files[[2]])
neg2<-fread(neg_files[[2]])
## T1 enhancers prediction based on T3 model
pos3<-fread(pos_files[[3]])
neg3<-fread(neg_files[[3]])
## T1 enhancers prediction based on T4 model
pos4<-fread(pos_files[[4]])
neg4<-fread(neg_files[[4]])
## T1 enhancers prediction based on T5 model
pos5<-fread(pos_files[[5]])
neg5<-fread(neg_files[[5]])
## T1 enhancers prediction based on T6 model
pos6<-fread(pos_files[[6]])
neg6<-fread(neg_files[[6]])
## calculate AUC
# T1 model cross validation
#pred <- prediction(crossV$V2, crossV$V3)
#perf <- performance( pred, "tpr", "fpr" )
#auc_temp <-performance( pred, measure = "auc")
#aucT1<-unlist(slot(auc_temp, "y.values"))
# T1 enhancers prediction based on other models
pos<-cbind(pos1,pos2$V2,pos3$V2,pos4$V2,pos5$V2,pos6$V2)
neg<-cbind(neg1,neg2$V2,neg3$V2,neg4$V2,neg5$V2,neg6$V2)
stage1<-rocPrArea(pos,neg)
aucOthers<-list(stage1[[1]],stage1[[2]],stage1[[3]])
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^(.*?)(?=_pos)")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i-1],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_pos.pred.using_early_constraint_model.txt'
hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_neg.pred.using_early_constraint_model.txt'
inverse_hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_pos.pred.using_early_constraint_model.txt'
inverse_hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_neg.pred.using_early_constraint_model.txt'
early_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_pos.pred.using_early_constraint_model.txt'
early_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_neg.pred.using_early_constraint_model.txt'
late_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_pos.pred.using_early_constraint_model.txt'
late_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_neg.pred.using_early_constraint_model.txt'
uniform_high_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_pos.pred.using_early_constraint_model.txt'
uniform_high_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_neg.pred.using_early_constraint_model.txt'
uniform_low_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_pos.pred.using_early_constraint_model.txt'
uniform_low_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_neg.pred.using_early_constraint_model.txt'
pos_files <- list(hourglass_pos, inverse_hourglass_pos, early_constraint_pos,
late_constraint_pos, uniform_high_pos, uniform_low_pos)
neg_files <- list(hourglass_neg, inverse_hourglass_neg, early_constraint_neg,
late_constraint_neg, uniform_high_neg, uniform_low_neg)
output_file = '/Users/children/Desktop/Stage_2025/Results/analyses/clean2/promoters/AUC/early_constraint_scores_OtherModel.pdf'
##### take T1 enhancers as an example #####
## T1 model cross validation
pos1<-fread(pos_files[[1]])
neg1<-fread(neg_files[[1]])
## T1 enhancers prediction based on T2 model
pos2<-fread(pos_files[[2]])
neg2<-fread(neg_files[[2]])
## T1 enhancers prediction based on T3 model
pos3<-fread(pos_files[[3]])
neg3<-fread(neg_files[[3]])
## T1 enhancers prediction based on T4 model
pos4<-fread(pos_files[[4]])
neg4<-fread(neg_files[[4]])
## T1 enhancers prediction based on T5 model
pos5<-fread(pos_files[[5]])
neg5<-fread(neg_files[[5]])
## T1 enhancers prediction based on T6 model
pos6<-fread(pos_files[[6]])
neg6<-fread(neg_files[[6]])
## calculate AUC
# T1 model cross validation
#pred <- prediction(crossV$V2, crossV$V3)
#perf <- performance( pred, "tpr", "fpr" )
#auc_temp <-performance( pred, measure = "auc")
#aucT1<-unlist(slot(auc_temp, "y.values"))
# T1 enhancers prediction based on other models
pos<-cbind(pos1,pos2$V2,pos3$V2,pos4$V2,pos5$V2,pos6$V2)
neg<-cbind(neg1,neg2$V2,neg3$V2,neg4$V2,neg5$V2,neg6$V2)
stage1<-rocPrArea(pos,neg)
aucOthers<-list(stage1[[1]],stage1[[2]],stage1[[3]])
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^(.*?)(?=_pos)")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i-1],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_pos.pred.using_inverse_hourglass_model.txt'
hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_neg.pred.using_inverse_hourglass_model.txt'
inverse_hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_pos.pred.using_inverse_hourglass_model.txt'
inverse_hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_neg.pred.using_inverse_hourglasst_model.txt'
early_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_pos.pred.using_inverse_hourglass_model.txt'
early_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_neg.pred.using_inverse_hourglass_model.txt'
late_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_pos.pred.using_inverse_hourglass_model.txt'
late_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_neg.pred.using_inverse_hourglass_model.txt'
uniform_high_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_pos.pred.using_inverse_hourglass_model.txt'
uniform_high_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_neg.pred.using_inverse_hourglass_model.txt'
uniform_low_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_pos.pred.using_inverse_hourglass_model.txt'
uniform_low_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_neg.pred.using_inverse_hourglass_model.txt'
pos_files <- list(hourglass_pos, inverse_hourglass_pos, early_constraint_pos,
late_constraint_pos, uniform_high_pos, uniform_low_pos)
neg_files <- list(hourglass_neg, inverse_hourglass_neg, early_constraint_neg,
late_constraint_neg, uniform_high_neg, uniform_low_neg)
output_file = '/Users/children/Desktop/Stage_2025/Results/analyses/clean2/promoters/AUC/inverse_hourglass_scores_OtherModel.pdf'
##### take T1 enhancers as an example #####
## T1 model cross validation
pos1<-fread(pos_files[[1]])
neg1<-fread(neg_files[[1]])
## T1 enhancers prediction based on T2 model
pos2<-fread(pos_files[[2]])
neg2<-fread(neg_files[[2]])
## T1 enhancers prediction based on T3 model
pos3<-fread(pos_files[[3]])
neg3<-fread(neg_files[[3]])
## T1 enhancers prediction based on T4 model
pos4<-fread(pos_files[[4]])
inverse_hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_neg.pred.using_inverse_hourglass_model.txt'
pos_files <- list(hourglass_pos, inverse_hourglass_pos, early_constraint_pos,
late_constraint_pos, uniform_high_pos, uniform_low_pos)
neg_files <- list(hourglass_neg, inverse_hourglass_neg, early_constraint_neg,
late_constraint_neg, uniform_high_neg, uniform_low_neg)
output_file = '/Users/children/Desktop/Stage_2025/Results/analyses/clean2/promoters/AUC/inverse_hourglass_scores_OtherModel.pdf'
##### take T1 enhancers as an example #####
## T1 model cross validation
pos1<-fread(pos_files[[1]])
neg1<-fread(neg_files[[1]])
## T1 enhancers prediction based on T2 model
pos2<-fread(pos_files[[2]])
neg2<-fread(neg_files[[2]])
## T1 enhancers prediction based on T3 model
pos3<-fread(pos_files[[3]])
neg3<-fread(neg_files[[3]])
## T1 enhancers prediction based on T4 model
pos4<-fread(pos_files[[4]])
neg4<-fread(neg_files[[4]])
## T1 enhancers prediction based on T5 model
pos5<-fread(pos_files[[5]])
neg5<-fread(neg_files[[5]])
## T1 enhancers prediction based on T6 model
pos6<-fread(pos_files[[6]])
neg6<-fread(neg_files[[6]])
## calculate AUC
# T1 model cross validation
#pred <- prediction(crossV$V2, crossV$V3)
#perf <- performance( pred, "tpr", "fpr" )
#auc_temp <-performance( pred, measure = "auc")
#aucT1<-unlist(slot(auc_temp, "y.values"))
# T1 enhancers prediction based on other models
pos<-cbind(pos1,pos2$V2,pos3$V2,pos4$V2,pos5$V2,pos6$V2)
neg<-cbind(neg1,neg2$V2,neg3$V2,neg4$V2,neg5$V2,neg6$V2)
stage1<-rocPrArea(pos,neg)
aucOthers<-list(stage1[[1]],stage1[[2]],stage1[[3]])
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^(.*?)(?=_pos)")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i-1],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_pos.pred.using_uniform_high_model.txt'
hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_neg.pred.using_uniform_high_model.txt'
inverse_hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_pos.pred.using_uniform_high_model.txt'
inverse_hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_neg.pred.using_uniform_high_model.txt'
early_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_pos.pred.using_uniform_high_model.txt'
early_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_neg.pred.using_uniform_high_model.txt'
late_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_pos.pred.using_uniform_high_model.txt'
late_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_neg.pred.using_uniform_high_model.txt'
uniform_high_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_pos.pred.using_uniform_high_model.txt'
uniform_high_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_neg.pred.using_uniform_high_model.txt'
uniform_low_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_pos.pred.using_uniform_high_model.txt'
uniform_low_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_neg.pred.using_uniform_high_model.txt'
pos_files <- list(hourglass_pos, inverse_hourglass_pos, early_constraint_pos,
late_constraint_pos, uniform_high_pos, uniform_low_pos)
neg_files <- list(hourglass_neg, inverse_hourglass_neg, early_constraint_neg,
late_constraint_neg, uniform_high_neg, uniform_low_neg)
output_file = '/Users/children/Desktop/Stage_2025/Results/analyses/clean2/promoters/AUC/uniform_high_scores_OtherModel.pdf'
##### take T1 enhancers as an example #####
## T1 model cross validation
pos1<-fread(pos_files[[1]])
neg1<-fread(neg_files[[1]])
## T1 enhancers prediction based on T2 model
pos2<-fread(pos_files[[2]])
neg2<-fread(neg_files[[2]])
## T1 enhancers prediction based on T3 model
pos3<-fread(pos_files[[3]])
neg3<-fread(neg_files[[3]])
## T1 enhancers prediction based on T4 model
pos4<-fread(pos_files[[4]])
neg4<-fread(neg_files[[4]])
## T1 enhancers prediction based on T5 model
pos5<-fread(pos_files[[5]])
neg5<-fread(neg_files[[5]])
## T1 enhancers prediction based on T6 model
pos6<-fread(pos_files[[6]])
neg6<-fread(neg_files[[6]])
## calculate AUC
# T1 model cross validation
#pred <- prediction(crossV$V2, crossV$V3)
#perf <- performance( pred, "tpr", "fpr" )
#auc_temp <-performance( pred, measure = "auc")
#aucT1<-unlist(slot(auc_temp, "y.values"))
# T1 enhancers prediction based on other models
pos<-cbind(pos1,pos2$V2,pos3$V2,pos4$V2,pos5$V2,pos6$V2)
neg<-cbind(neg1,neg2$V2,neg3$V2,neg4$V2,neg5$V2,neg6$V2)
stage1<-rocPrArea(pos,neg)
aucOthers<-list(stage1[[1]],stage1[[2]],stage1[[3]])
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^(.*?)(?=_pos)")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i-1],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_pos.pred.using_uniform_low_model.txt'
hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/hourglass_neg.pred.using_uniform_low_model.txt'
inverse_hourglass_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_pos.pred.using_uniform_low_model.txt'
inverse_hourglass_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/inverse_hourglass_neg.pred.using_uniform_low_model.txt'
early_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_pos.pred.using_uniform_low_model.txt'
early_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/early_constraint_neg.pred.using_uniform_low_model.txt'
late_constraint_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_pos.pred.using_uniform_low_model.txt'
late_constraint_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/late_constraint_neg.pred.using_uniform_low_model.txt'
uniform_high_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_pos.pred.using_uniform_low_model.txt'
uniform_high_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_high_neg.pred.using_uniform_low_model.txt'
uniform_low_pos = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_pos.pred.using_uniform_low_model.txt'
uniform_low_neg = '/Users/children/Desktop/Stage_2025/Results/prediction/clean2/promoters/uniform_low_neg.pred.using_uniform_low_model.txt'
pos_files <- list(hourglass_pos, inverse_hourglass_pos, early_constraint_pos,
late_constraint_pos, uniform_high_pos, uniform_low_pos)
neg_files <- list(hourglass_neg, inverse_hourglass_neg, early_constraint_neg,
late_constraint_neg, uniform_high_neg, uniform_low_neg)
output_file = '/Users/children/Desktop/Stage_2025/Results/analyses/clean2/promoters/AUC/uniform_low_scores_OtherModel.pdf'
##### take T1 enhancers as an example #####
## T1 model cross validation
pos1<-fread(pos_files[[1]])
neg1<-fread(neg_files[[1]])
## T1 enhancers prediction based on T2 model
pos2<-fread(pos_files[[2]])
neg2<-fread(neg_files[[2]])
## T1 enhancers prediction based on T3 model
pos3<-fread(pos_files[[3]])
neg3<-fread(neg_files[[3]])
## T1 enhancers prediction based on T4 model
pos4<-fread(pos_files[[4]])
neg4<-fread(neg_files[[4]])
## T1 enhancers prediction based on T5 model
pos5<-fread(pos_files[[5]])
neg5<-fread(neg_files[[5]])
## T1 enhancers prediction based on T6 model
pos6<-fread(pos_files[[6]])
neg6<-fread(neg_files[[6]])
## calculate AUC
# T1 model cross validation
#pred <- prediction(crossV$V2, crossV$V3)
#perf <- performance( pred, "tpr", "fpr" )
#auc_temp <-performance( pred, measure = "auc")
#aucT1<-unlist(slot(auc_temp, "y.values"))
# T1 enhancers prediction based on other models
pos<-cbind(pos1,pos2$V2,pos3$V2,pos4$V2,pos5$V2,pos6$V2)
neg<-cbind(neg1,neg2$V2,neg3$V2,neg4$V2,neg5$V2,neg6$V2)
stage1<-rocPrArea(pos,neg)
aucOthers<-list(stage1[[1]],stage1[[2]],stage1[[3]])
## plot
pdf(file = output_file, width = 8, height = 7)
plotColors<-c("pink","orange","lightblue","purple","lightgreen","brown")
plotLegend = list()
file_name <- tools::file_path_sans_ext(basename(hourglass_pos))
model <- str_extract(file_name, "(?<=using_)[^.]+")
for (file_path in pos_files) {
file_name <- tools::file_path_sans_ext(basename(file_path))
cluster <- str_extract(file_name, "^(.*?)(?=_pos)")
plotLegend <- append(plotLegend, cluster)}
par(mar=c(5,5,2,2))
plot(unlist(aucOthers[[1]][1]),unlist(aucOthers[[2]][1]),col=plotColors[1], lwd = 3,cex=1.5,main=paste0("D.melanogaster ",model," promoters"),xlab="False positive rate",ylab="Ture positive rate",
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,type="l")
legend(0.2,0.6,paste(plotLegend[1]," ","(AUC = ",round(aucOthers[[3]][1],digits = 3),")",sep=""),lwd = 3,bty="n",cex=1.4,col = plotColors[1])
for (i in 2:6) {
lines(unlist(aucOthers[[1]][i]),unlist(aucOthers[[2]][i]),col=plotColors[i],lwd=3)}
legendY<-c(0.5, 0.4, 0.3, 0.2, 0.1)
for (i in 2:6) {
legendName<-paste(plotLegend[i]," ","(AUC = ",round(aucOthers[[3]][i],digits = 3),")",sep="")
legend(0.2,legendY[i-1],legendName,lwd = 3,bty="n",cex=1.4,col = plotColors[i])
}
dev.off()
